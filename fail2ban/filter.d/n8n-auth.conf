# fail2ban filter for n8n authentication failures
# Copy to: /etc/fail2ban/filter.d/n8n-auth.conf

[Definition]
# Match failed login attempts in n8n Docker container logs
# n8n logs auth failures with 401 status codes

failregex = ^.*"POST.*/rest/login.*" 401.*<HOST>.*$
            ^.*<HOST>.*"POST.*/rest/login.*" 401.*$
            ^.*401.*<HOST>.*login.*$

ignoreregex =

# Date pattern for Docker JSON logs
datepattern = ^%%Y-%%m-%%dT%%H:%%M:%%S
